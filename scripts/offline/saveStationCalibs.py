import os,sys
import ROOT

outdir = "/w2/arianna/2013_Calibrations"
otag = "SingleSided"

calsets = {
    # see elog:1044
    '0002F7F175B7': { 0: {  1: (0.968, 0.001,  0.67, 0.09),
                           -1: (0.968, 0.001,  0.67, 0.09) },
                      1: {  1: (0.951, 0.005,  1.4, 0.8),
                           -1: (0.951, 0.005,  1.4, 0.8) },
                      2: {  1: (0.974, 0.002,  0.6, 0.3),
                           -1: (0.974, 0.002,  0.6, 0.3) },
                      3: {  1: (0.953, 0.001,  0.6, 0.3),
                           -1: (0.953, 0.001,  0.6, 0.3) },
                      },
    '0002F7F0C61A': { 0: {  1: (0.920, 0.001,  1.3, 0.2),
                           -1: (0.920, 0.001,  1.3, 0.2) },
                      1: {  1: (0.919, 0.002,  0.8, 0.3),
                           -1: (0.919, 0.002,  0.8, 0.3) },
                      2: {  1: (0.918, 0.001,  1.1, 0.2),
                           -1: (0.918, 0.001,  1.1, 0.2) },
                      3: {  1: (0.898, 0.004,  3.3, 0.7),
                           -1: (0.898, 0.004,  3.3, 0.7) },
                      },
    '0002F7F0C561': { 0: {  1: (0.914, 0.002,  0.5, 0.3),
                           -1: (0.914, 0.002,  0.5, 0.3) },
                      1: {  1: (0.916, 0.003,  0.7, 0.4),
                           -1: (0.916, 0.003,  0.7, 0.4) },
                      2: {  1: (0.916, 0.003,  1.0, 0.5),
                           -1: (0.916, 0.003,  1.0, 0.5) },
                      3: {  1: (0.932, 0.002,  0.5, 0.2),
                           -1: (0.932, 0.002,  0.5, 0.2) },
                      },
    
    # these are from the old method (elog:1176 and elog:401)
    '0002F7F0C3B6': { 0: {  1: (0.804, 0.008,  0.4, 4.5),
                           -1: (0.804, 0.008,  0.4, 4.5) },
                      1: {  1: (0.810, 0.009,  1.0, 5.1),
                           -1: (0.810, 0.009,  1.0, 5.1) },
                      2: {  1: (0.804, 0.010,  2.5, 5.7),
                           -1: (0.804, 0.010,  2.5, 5.7) },
                      3: {  1: (0.807, 0.011,  1.1, 6.2),
                           -1: (0.807, 0.011,  1.1, 6.2) },
                      }
    }

def main():
    if not os.path.exists(outdir):
        os.makedirs(outdir)
    
    for stn, chcals in calsets.iteritems():
        outfn = "{0}/ReadoutCalibSet.{1}.{2}.root".format(outdir, otag, stn)
        outf = ROOT.TFile(outfn,"RECREATE")
        cs = ROOT.TSnDualGainCalibSet("DigitizerCalibSet")
        for ch, vc in chcals.iteritems():
            cs.AddCalibAtChan(ch,
                          vc[1][0], vc[1][1], vc[1][2], vc[1][3],
                          vc[-1][0], vc[-1][1], vc[-1][2], vc[-1][3])
        outf.cd()
        cs.Write()
        print "Wrote [{0}]".format(outf.GetName())
    

if __name__=="__main__":
    main()
